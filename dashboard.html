<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ©å°»å³¶æ˜†å¸ƒå¹²å ´äºˆå ±ã‚·ã‚¹ãƒ†ãƒ  - çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            margin-right: 15px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            color: white;
        }

        .card-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c3e50;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-healthy { background-color: #27ae60; }
        .status-warning { background-color: #f39c12; }
        .status-critical { background-color: #e74c3c; }

        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .metric-label {
            font-weight: 500;
            color: #555;
        }

        .metric-value {
            font-weight: 600;
            color: #2c3e50;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .action-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .action-button.urgent {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .action-button.urgent:hover {
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            font-style: italic;
            color: #7f8c8d;
        }

        .error {
            background: #fee;
            color: #c0392b;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
        }

        .chart-container {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .alert-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 8px 0;
            border-radius: 8px;
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }

        .alert-item.danger {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .alert-item.watch {
            background: #d1ecf1;
            border-left-color: #17a2b8;
        }

        .refresh-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
            transition: all 0.3s ease;
        }

        .refresh-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4);
        }

        @media (max-width: 768px) {
            .dashboard-container {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .quick-actions {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>ğŸŒŠ åˆ©å°»å³¶æ˜†å¸ƒå¹²å ´äºˆå ±ã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ãƒ»åˆ†æ</p>
            <p id="lastUpdate">æœ€çµ‚æ›´æ–°: èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>

        <div class="dashboard-grid">
            <!-- ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦ã‚«ãƒ¼ãƒ‰ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #3498db;">âš™ï¸</div>
                    <div class="card-title">ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦</div>
                </div>
                <div id="systemOverview" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>

            <!-- å¤©æ°—æ¦‚è¦ã‚«ãƒ¼ãƒ‰ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #f39c12;">ğŸŒ¤ï¸</div>
                    <div class="card-title">å¤©æ°—æ¦‚è¦</div>
                </div>
                <div id="weatherSummary" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>

            <!-- æµ·éœ§çŠ¶æ³ã‚«ãƒ¼ãƒ‰ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #9b59b6;">ğŸŒ«ï¸</div>
                    <div class="card-title">æµ·éœ§çŠ¶æ³</div>
                </div>
                <div id="seaFogStatus" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>

            <!-- æ¼æœŸçŠ¶æ³ã‚«ãƒ¼ãƒ‰ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #27ae60;">ğŸ£</div>
                    <div class="card-title">æ¼æœŸçŠ¶æ³</div>
                </div>
                <div id="fishingSeasonStatus" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>

            <!-- é€šçŸ¥æ¦‚è¦ã‚«ãƒ¼ãƒ‰ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #e74c3c;">ğŸ“¢</div>
                    <div class="card-title">é€šçŸ¥æ¦‚è¦</div>
                </div>
                <div id="notificationSummary" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>

            <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™ã‚«ãƒ¼ãƒ‰ -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon" style="background: #34495e;">ğŸ“Š</div>
                    <div class="card-title">ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™</div>
                </div>
                <div id="performanceMetrics" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>
        </div>

        <!-- æœ€è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒˆ -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon" style="background: #e67e22;">âš ï¸</div>
                <div class="card-title">æœ€è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒˆ</div>
            </div>
            <div id="recentAlerts" class="loading">ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>

        <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="quick-actions">
            <button class="action-button" onclick="window.open('/', '_blank')">ğŸ—ºï¸ åœ°å›³è¡¨ç¤º</button>
            <button class="action-button" onclick="refreshDashboard()">ğŸ”„ ãƒ‡ãƒ¼ã‚¿æ›´æ–°</button>
            <button class="action-button" onclick="viewHistoricalData()">ğŸ“ˆ å±¥æ­´åˆ†æ</button>
            <button class="action-button urgent" onclick="viewAlerts()">ğŸš¨ ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª</button>
            <button class="action-button" onclick="exportData()">ğŸ’¾ ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›</button>
            <button class="action-button" onclick="systemSettings()">âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</button>
        </div>
    </div>

    <button class="refresh-button" onclick="refreshDashboard()">ğŸ”„ æ›´æ–°</button>

    <script>
        let dashboardData = null;
        let autoRefreshInterval = null;

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åˆæœŸåŒ–
        function initDashboard() {
            loadDashboardData();
            startAutoRefresh();
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        async function loadDashboardData() {
            try {
                const response = await fetch('/visualization/dashboard');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                dashboardData = await response.json();
                
                if (dashboardData.error) {
                    throw new Error(dashboardData.error);
                }
                
                updateDashboard();
                updateLastUpdateTime();
                
            } catch (error) {
                console.error('Dashboard data load error:', error);
                showError('ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
            }
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºæ›´æ–°
        function updateDashboard() {
            if (!dashboardData) return;

            updateSystemOverview();
            updateWeatherSummary();
            updateSeaFogStatus();
            updateFishingSeasonStatus();
            updateNotificationSummary();
            updatePerformanceMetrics();
            updateRecentAlerts();
        }

        // ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦æ›´æ–°
        function updateSystemOverview() {
            const overview = dashboardData.system_overview;
            const container = document.getElementById('systemOverview');
            
            if (overview.error) {
                container.innerHTML = `<div class="error">${overview.error}</div>`;
                return;
            }

            const healthStatus = overview.system_health;
            const statusClass = healthStatus === 'healthy' ? 'status-healthy' : 
                              healthStatus === 'warning' ? 'status-warning' : 'status-critical';

            let html = `
                <div class="metric-row">
                    <span class="metric-label">
                        <span class="status-indicator ${statusClass}"></span>
                        ã‚·ã‚¹ãƒ†ãƒ å¥å…¨æ€§
                    </span>
                    <span class="metric-value">${healthStatus}</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ãƒ©ãƒ¼ãƒˆ</span>
                    <span class="metric-value">${overview.active_alerts}</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</span>
                    <span class="metric-value">${overview.total_users}</span>
                </div>
            `;

            // ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹
            html += '<div style="margin-top: 15px; font-weight: 600; color: #555;">ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹:</div>';
            for (const [service, status] of Object.entries(overview.services_status)) {
                const serviceStatus = status === 'active' || status === 'available' ? 'status-healthy' : 'status-critical';
                html += `
                    <div style="margin: 5px 0; padding: 5px; font-size: 0.9em;">
                        <span class="status-indicator ${serviceStatus}"></span>
                        ${service}: ${status}
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // å¤©æ°—æ¦‚è¦æ›´æ–°
        function updateWeatherSummary() {
            const weather = dashboardData.weather_summary;
            const container = document.getElementById('weatherSummary');
            
            if (weather.error) {
                container.innerHTML = `<div class="error">${weather.error}</div>`;
                return;
            }

            const current = weather.current_conditions;
            
            let html = `
                <div class="metric-row">
                    <span class="metric-label">ç¾åœ¨ã®å¤©æ°—</span>
                    <span class="metric-value">${current.condition}</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">æ°—æ¸©</span>
                    <span class="metric-value">${current.temperature}Â°C</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">é¢¨é€Ÿ</span>
                    <span class="metric-value">${current.wind_speed}m/s (${current.wind_direction})</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">æ¹¿åº¦</span>
                    <span class="metric-value">${current.humidity}%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">è¦–ç¨‹</span>
                    <span class="metric-value">${(current.visibility / 1000).toFixed(1)}km</span>
                </div>
            `;

            container.innerHTML = html;
        }

        // æµ·éœ§çŠ¶æ³æ›´æ–°
        function updateSeaFogStatus() {
            const seaFog = dashboardData.sea_fog_status;
            const container = document.getElementById('seaFogStatus');
            
            if (seaFog.error) {
                container.innerHTML = `<div class="error">${seaFog.error}</div>`;
                return;
            }

            let html = `
                <div class="metric-row">
                    <span class="metric-label">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–è­¦å ±</span>
                    <span class="metric-value">${seaFog.active_alerts || 0}</span>
                </div>
            `;

            // åœ°ç‚¹åˆ¥ãƒªã‚¹ã‚¯
            if (seaFog.current_risk) {
                html += '<div style="margin-top: 15px; font-weight: 600; color: #555;">åœ°ç‚¹åˆ¥ãƒªã‚¹ã‚¯:</div>';
                for (const [location, risk] of Object.entries(seaFog.current_risk)) {
                    const riskLevel = risk.max_probability;
                    const riskColor = riskLevel >= 0.8 ? '#e74c3c' : riskLevel >= 0.6 ? '#f39c12' : '#27ae60';
                    
                    html += `
                        <div style="margin: 8px 0; padding: 8px; background: #f8f9fa; border-radius: 5px;">
                            <div style="font-weight: 600;">${location}</div>
                            <div style="color: ${riskColor}; font-weight: 600;">
                                æœ€å¤§ç¢ºç‡: ${(riskLevel * 100).toFixed(1)}%
                            </div>
                            <div style="font-size: 0.9em; color: #666;">
                                æ¨å¥¨: ${risk.recommendation}
                            </div>
                        </div>
                    `;
                }
            }

            container.innerHTML = html;
        }

        // æ¼æœŸçŠ¶æ³æ›´æ–°
        function updateFishingSeasonStatus() {
            const season = dashboardData.fishing_season_status;
            const container = document.getElementById('fishingSeasonStatus');
            
            if (season.error) {
                container.innerHTML = `<div class="error">${season.error}</div>`;
                return;
            }

            let html = `
                <div class="metric-row">
                    <span class="metric-label">ç¾åœ¨ã®çŠ¶æ³</span>
                    <span class="metric-value">${season.current_status}</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">é€²æ—</span>
                    <span class="metric-value">${season.progress_percentage.toFixed(1)}%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">æ®‹ã‚Šæ—¥æ•°</span>
                    <span class="metric-value">${season.days_remaining}æ—¥</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">ä»Šé€±ã®ä½œæ¥­æ—¥æ•°</span>
                    <span class="metric-value">${season.work_days_this_week}æ—¥</span>
                </div>
            `;

            container.innerHTML = html;
        }

        // é€šçŸ¥æ¦‚è¦æ›´æ–°
        function updateNotificationSummary() {
            const notifications = dashboardData.notification_summary;
            const container = document.getElementById('notificationSummary');
            
            if (notifications.error) {
                container.innerHTML = `<div class="error">${notifications.error}</div>`;
                return;
            }

            let html = `
                <div class="metric-row">
                    <span class="metric-label">ä»Šæ—¥ã®é€šçŸ¥æ•°</span>
                    <span class="metric-value">${notifications.daily_notifications}</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">æˆåŠŸç‡</span>
                    <span class="metric-value">${(notifications.success_rate * 100).toFixed(1)}%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–è³¼èª­</span>
                    <span class="metric-value">${notifications.active_subscriptions}</span>
                </div>
            `;

            container.innerHTML = html;
        }

        // ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™æ›´æ–°
        function updatePerformanceMetrics() {
            const performance = dashboardData.performance_metrics;
            const container = document.getElementById('performanceMetrics');
            
            if (performance.error) {
                container.innerHTML = `<div class="error">${performance.error}</div>`;
                return;
            }

            let html = `
                <div class="metric-row">
                    <span class="metric-label">ã‚·ã‚¹ãƒ†ãƒ ç¨¼åƒç‡</span>
                    <span class="metric-value">${performance.system_uptime}</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">äºˆæ¸¬ç²¾åº¦</span>
                    <span class="metric-value">${(performance.prediction_accuracy * 100).toFixed(1)}%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">å¿œç­”æ™‚é–“</span>
                    <span class="metric-value">${performance.response_time_ms}ms</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">ã‚­ãƒ£ãƒƒã‚·ãƒ¥å‘½ä¸­ç‡</span>
                    <span class="metric-value">${(performance.cache_hit_rate * 100).toFixed(1)}%</span>
                </div>
            `;

            container.innerHTML = html;
        }

        // æœ€è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒˆæ›´æ–°
        function updateRecentAlerts() {
            const alerts = dashboardData.recent_alerts;
            const container = document.getElementById('recentAlerts');
            
            if (!alerts || alerts.length === 0) {
                container.innerHTML = '<div style="text-align: center; color: #27ae60; padding: 20px;">âœ… ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¢ãƒ©ãƒ¼ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“</div>';
                return;
            }

            let html = '';
            for (const alert of alerts.slice(0, 5)) {
                const alertClass = alert.level === 'danger' ? 'danger' : 
                                 alert.level === 'watch' ? 'watch' : '';
                
                html += `
                    <div class="alert-item ${alertClass}">
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">${alert.message}</div>
                            <div style="font-size: 0.9em; color: #666; margin-top: 5px;">
                                ${alert.zone} - ${new Date(alert.timestamp).toLocaleString('ja-JP')}
                            </div>
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        function showError(message) {
            const containers = [
                'systemOverview', 'weatherSummary', 'seaFogStatus', 
                'fishingSeasonStatus', 'notificationSummary', 'performanceMetrics'
            ];
            
            containers.forEach(id => {
                document.getElementById(id).innerHTML = `<div class="error">${message}</div>`;
            });
        }

        // æœ€çµ‚æ›´æ–°æ™‚åˆ»æ›´æ–°
        function updateLastUpdateTime() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = 
                `æœ€çµ‚æ›´æ–°: ${now.toLocaleString('ja-JP')}`;
        }

        // è‡ªå‹•æ›´æ–°é–‹å§‹
        function startAutoRefresh() {
            stopAutoRefresh();
            autoRefreshInterval = setInterval(refreshDashboard, 300000); // 5åˆ†é–“éš”
        }

        // è‡ªå‹•æ›´æ–°åœæ­¢
        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°
        function refreshDashboard() {
            loadDashboardData();
        }

        // å±¥æ­´ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
        function viewHistoricalData() {
            const days = prompt('åˆ†æå¯¾è±¡ã®æ—¥æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30æ—¥)', '30');
            if (days) {
                window.open(`/visualization/historical?days=${days}`, '_blank');
            }
        }

        // ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª
        function viewAlerts() {
            alert('ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
        }

        // ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
        async function exportData() {
            try {
                const response = await fetch('/visualization/export', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ format: 'json' })
                });
                
                const result = await response.json();
                if (result.status === 'success') {
                    alert(`ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ: ${result.export_path}`);
                } else {
                    alert(`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ: ${result.error}`);
                }
            } catch (error) {
                alert(`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }

        // ã‚·ã‚¹ãƒ†ãƒ è¨­å®š
        function systemSettings() {
            alert('ã‚·ã‚¹ãƒ†ãƒ è¨­å®šæ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', initDashboard);

        // ãƒšãƒ¼ã‚¸ã‚’é›¢ã‚Œã‚‹å‰ã®è‡ªå‹•æ›´æ–°åœæ­¢
        window.addEventListener('beforeunload', stopAutoRefresh);
    </script>
</body>
</html>