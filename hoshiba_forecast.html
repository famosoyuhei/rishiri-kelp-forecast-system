<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹²å ´äºˆå ± - åˆ©å°»å³¶æ˜†å¸ƒå¹²ã—äºˆå ±ã‚·ã‚¹ãƒ†ãƒ </title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Hiragino Sans', 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ã‚·ãƒƒã‚¯', 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 480px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #0984e3, #74b9ff);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        
        .back-btn {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .header h1 {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .hoshiba-info {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .forecast-tabs {
            display: flex;
            background: #f8f9fa;
            overflow-x: auto;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px 8px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            color: #636e72;
            transition: all 0.3s;
            white-space: nowrap;
            min-width: 80px;
        }
        
        .tab-btn.active {
            background: white;
            color: #0984e3;
            border-bottom: 3px solid #0984e3;
        }
        
        .tab-btn:hover {
            background: #e8f4ff;
        }
        
        .forecast-content {
            padding: 20px;
            min-height: 400px;
        }
        
        .forecast-day {
            display: none;
        }
        
        .forecast-day.active {
            display: block;
        }
        
        .overall-condition {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .condition-excellent {
            background: linear-gradient(135deg, #00b894, #55efc4);
            color: white;
        }
        
        .condition-good {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
        }
        
        .condition-fair {
            background: linear-gradient(135deg, #fd79a8, #fdcb6e);
            color: white;
        }
        
        .condition-poor {
            background: linear-gradient(135deg, #d63031, #fd79a8);
            color: white;
        }
        
        .forecast-sections {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .forecast-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
        }
        
        .section-header {
            font-weight: bold;
            font-size: 16px;
            color: #2d3436;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .time-range {
            font-size: 12px;
            background: #636e72;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
        }
        
        .hourly-forecast {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
        }
        
        .hour-item {
            text-align: center;
            background: white;
            border-radius: 8px;
            padding: 10px 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .hour-time {
            font-size: 11px;
            color: #636e72;
            margin-bottom: 5px;
        }
        
        .hour-value {
            font-weight: bold;
            font-size: 14px;
            color: #2d3436;
        }
        
        .hour-unit {
            font-size: 10px;
            color: #636e72;
        }
        
        .wind-direction {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .wind-arrow {
            font-size: 20px;
            margin-bottom: 2px;
        }
        
        .theta-diff {
            font-size: 10px;
            color: #e17055;
            font-weight: bold;
        }
        
        .judgment-section {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .judgment-title {
            font-size: 18px;
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .judgment-result {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .judgment-excellent { color: #00b894; }
        .judgment-good { color: #fdcb6e; }
        .judgment-fair { color: #fd79a8; }
        .judgment-poor { color: #d63031; }
        
        .judgment-reasons {
            font-size: 14px;
            color: #1976d2;
            line-height: 1.5;
        }
        
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0984e3;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            text-align: center;
            color: #d63031;
            background: #ffebee;
            padding: 20px;
            border-radius: 10px;
            margin: 20px;
        }
        
        @media (max-width: 400px) {
            .hourly-forecast {
                grid-template-columns: repeat(auto-fit, minmax(50px, 1fr));
            }
            
            .hour-item {
                padding: 8px 3px;
            }
            
            .forecast-tabs {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <button class="back-btn" onclick="goBack()">â† æˆ»ã‚‹</button>
            <h1 id="hoshibaName">å¹²å ´äºˆå ±</h1>
            <div class="hoshiba-info" id="hoshibaInfo">
                <!-- å¹²å ´æƒ…å ±ãŒå‹•çš„ã«è¨­å®šã•ã‚Œã¾ã™ -->
            </div>
        </div>
        
        <div class="forecast-tabs">
            <button class="tab-btn active" data-day="0">æ˜æ—¥</button>
            <button class="tab-btn" data-day="1">æ˜å¾Œæ—¥</button>
            <button class="tab-btn" data-day="2">3æ—¥å¾Œ</button>
            <button class="tab-btn" data-day="3">4æ—¥å¾Œ</button>
            <button class="tab-btn" data-day="4">5æ—¥å¾Œ</button>
            <button class="tab-btn" data-day="5">6æ—¥å¾Œ</button>
            <button class="tab-btn" data-day="6">7æ—¥å¾Œ</button>
        </div>
        
        <div class="forecast-content">
            <div id="loading" class="loading-spinner">
                <div class="spinner"></div>
            </div>
            
            <div id="error" class="error-message" style="display: none;">
                äºˆå ±ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ
            </div>
            
            <!-- å„æ—¥ã®äºˆå ± -->
            <div class="forecast-day active" data-day="0">
                <div class="overall-condition condition-excellent">
                    ğŸŒŸ å¹²ã›ã‚‹ï¼ï¼ˆæœ€è‰¯æ¡ä»¶ï¼‰
                </div>
                
                <div class="forecast-sections">
                    <!-- åŸºæœ¬æ°—è±¡æ¡ä»¶ï¼ˆåˆå‰4æ™‚ã€œåˆå¾Œ4æ™‚ï¼‰ -->
                    <div class="forecast-section">
                        <div class="section-header">
                            ğŸŒ¡ï¸ åŸºæœ¬æ°—è±¡æ¡ä»¶
                            <span class="time-range">04:00-16:00</span>
                        </div>
                        <div class="hourly-forecast" id="basicWeather">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <!-- é¢¨å‘ãƒ»é¢¨é€Ÿï¼ˆåˆå‰4æ™‚ã€œåˆå‰10æ™‚ï¼‰ -->
                    <div class="forecast-section">
                        <div class="section-header">
                            ğŸ’¨ é¢¨å‘ãƒ»é¢¨é€Ÿ
                            <span class="time-range">04:00-10:00</span>
                        </div>
                        <div class="hourly-forecast" id="windData">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <!-- æ—¥å°„ãƒ»é›²é‡ç­‰ï¼ˆåˆå‰10æ™‚ã€œåˆå¾Œ4æ™‚ï¼‰ -->
                    <div class="forecast-section">
                        <div class="section-header">
                            â˜€ï¸ æ—¥å°„ãƒ»é›²é‡
                            <span class="time-range">10:00-16:00</span>
                        </div>
                        <div class="hourly-forecast" id="solarData">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- åˆ¤å®šçµæœ -->
                <div class="judgment-section">
                    <div class="judgment-title">ğŸ¯ å¹²ã›ã‚‹ã‹ã©ã†ã‹ã®åˆ¤å®š</div>
                    <div class="judgment-result judgment-excellent">
                        å¹²ã›ã‚‹ï¼ï¼ˆä¿¡é ¼åº¦: 95%ï¼‰
                    </div>
                    <div class="judgment-reasons">
                        â€¢ è¥¿åŒ—è¥¿é¢¨ã§æ¹¿åº¦ãŒä½ãä¿ãŸã‚Œã‚‹<br>
                        â€¢ é¢¨é€ŸãŒé©åº¦ã§ä¹¾ç‡¥ã«æœ€é©<br>
                        â€¢ é›²é‡ãŒå°‘ãªãæ—¥å°„é‡ãŒååˆ†<br>
                        â€¢ Î¸è§’åº¦å·®ã«ã‚ˆã‚Šé¢¨å‘ãŒæœ‰åˆ©
                    </div>
                </div>
            </div>
            
            <!-- ä»–ã®æ—¥ã®äºˆå ±ã¯å‹•çš„ã«ç”Ÿæˆ -->
            <div class="forecast-day" data-day="1" style="display: none;">
                <!-- 2æ—¥å¾Œã®äºˆå ± -->
            </div>
            
            <!-- ä»¥ä¸‹åŒæ§˜ã«7æ—¥åˆ† -->
        </div>
    </div>
    
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentHoshiba = null;
        let forecastData = null;
        
        // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰å¹²å ´æƒ…å ±ã‚’å–å¾—
        function getHoshibaFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return {
                name: urlParams.get('name') || 'H_1021_2473',
                town: urlParams.get('town') || 'åˆ©å°»å¯Œå£«ç”º',
                district: urlParams.get('district') || 'é¬¼è„‡',
                buraku: urlParams.get('buraku') || 'é‡ä¸­',
                theta: parseFloat(urlParams.get('theta')) || 23.5,
                lat: parseFloat(urlParams.get('lat')) || 45.1021947,
                lon: parseFloat(urlParams.get('lon')) || 141.247311
            };
        }
        
        // åˆæœŸåŒ–
        function init() {
            currentHoshiba = getHoshibaFromURL();
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã‚’è¨­å®š
            document.getElementById('hoshibaName').textContent = currentHoshiba.name;
            document.getElementById('hoshibaInfo').innerHTML = `
                ${currentHoshiba.town} ${currentHoshiba.district} ${currentHoshiba.buraku}<br>
                Î¸: ${currentHoshiba.theta.toFixed(1)}Â° | ${currentHoshiba.lat.toFixed(4)}Â°N, ${currentHoshiba.lon.toFixed(4)}Â°E
            `;
            
            // ã‚¿ãƒ–ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
            setupTabListeners();
            
            // äºˆå ±ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
            loadForecastData();
        }
        
        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
        function setupTabListeners() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const day = btn.dataset.day;
                    switchToDay(day);
                });
            });
        }
        
        function switchToDay(day) {
            // ã‚¿ãƒ–ã®åˆ‡ã‚Šæ›¿ãˆ
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-day="${day}"]`).classList.add('active');
            
            // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ‡ã‚Šæ›¿ãˆ
            document.querySelectorAll('.forecast-day').forEach(content => {
                content.style.display = 'none';
            });
            
            // è©²å½“æ—¥ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
            displayForecastForDay(day);
        }
        
        // äºˆå ±ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        async function loadForecastData() {
            try {
                document.getElementById('loading').style.display = 'flex';
                document.getElementById('error').style.display = 'none';
                
                // å®Ÿéš›ã®APIã‚³ãƒ¼ãƒ«
                const response = await fetch('http://localhost:5001/api/forecast-detailed', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        hoshiba: currentHoshiba,
                        days: 7
                    })
                });
                
                if (response.ok) {
                    forecastData = await response.json();
                } else {
                    throw new Error('API Error');
                }
                
            } catch (error) {
                console.warn('API not available, using mock data');
                forecastData = generateMockForecastData();
            }
            
            document.getElementById('loading').style.display = 'none';
            displayForecastForDay(0);
        }
        
        // ãƒ¢ãƒƒã‚¯äºˆå ±ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        function generateMockForecastData() {
            const data = { days: [] };
            
            for (let day = 0; day < 7; day++) {
                const date = new Date();
                date.setDate(date.getDate() + day + 1);
                
                const dayData = {
                    date: date.toISOString().split('T')[0],
                    overall_condition: day < 3 ? 'excellent' : day < 5 ? 'good' : 'fair',
                    confidence: Math.max(70, 95 - day * 5),
                    basic_weather: generateHourlyData(4, 16, 'basic'),
                    wind_data: generateHourlyData(4, 10, 'wind'),
                    solar_data: generateHourlyData(10, 16, 'solar'),
                    judgment: {
                        result: day < 3 ? 'å¹²ã›ã‚‹ï¼' : day < 5 ? 'æ¡ä»¶ä»˜ãã§å¹²ã›ã‚‹' : 'è¦æ³¨æ„',
                        reasons: [
                            day < 3 ? 'è¥¿åŒ—è¥¿é¢¨ã§æ¹¿åº¦ãŒä½ãä¿ãŸã‚Œã‚‹' : 'å—é¢¨ã®ãŸã‚æ¹¿åº¦ãŒã‚„ã‚„é«˜ã‚',
                            'é¢¨é€ŸãŒé©åº¦ã§ä¹¾ç‡¥ã«é©ã—ã¦ã„ã‚‹',
                            day < 4 ? 'é›²é‡ãŒå°‘ãªãæ—¥å°„é‡ãŒååˆ†' : 'æ›‡ã‚ŠãŒã¡ã§æ—¥å°„é‡ãŒä¸ååˆ†',
                            'Î¸è§’åº¦å·®ã«ã‚ˆã‚Šé¢¨å‘ãŒ' + (day < 3 ? 'æœ‰åˆ©' : 'ä¸åˆ©')
                        ]
                    }
                };
                
                data.days.push(dayData);
            }
            
            return data;
        }
        
        // æ™‚é–“åˆ¥ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        function generateHourlyData(startHour, endHour, type) {
            const data = [];
        
            for (let hour = startHour; hour <= endHour; hour++) {
                const hourData = { hour: hour };
                
                if (type === 'basic') {
                    hourData.temperature = 15 + Math.sin((hour - 6) * Math.PI / 12) * 8 + Math.random() * 2;
                    hourData.humidity = 60 + Math.sin((hour - 12) * Math.PI / 8) * 15 + Math.random() * 5;
                } else if (type === 'wind') {
                    hourData.direction = 280 + Math.random() * 40; // WNWä¸­å¿ƒ
                    hourData.speed = 5 + Math.random() * 4;
                    hourData.theta_diff = Math.abs(hourData.direction - currentHoshiba.theta);
                    if (hourData.theta_diff > 180) hourData.theta_diff = 360 - hourData.theta_diff;
                } else if (type === 'solar') {
                    hourData.solar = Math.max(0, Math.sin((hour - 6) * Math.PI / 10) * 800 + Math.random() * 100);
                    hourData.cloud = 20 + Math.random() * 30;
                    hourData.pressure_velocity = (Math.random() - 0.5) * 0.1;
                    hourData.ssi = -2 + Math.random() * 6;
                    hourData.equivalent_potential_temp = 320 + Math.random() * 10;
                }
                
                data.push(hourData);
            }
            
            return data;
        }
        
        // æŒ‡å®šæ—¥ã®äºˆå ±ã‚’è¡¨ç¤º
        function displayForecastForDay(dayIndex) {
            if (!forecastData || !forecastData.days[dayIndex]) {
                return;
            }
            
            const dayData = forecastData.days[dayIndex];
            
            // æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¯ãƒªã‚¢
            let dayContainer = document.querySelector(`.forecast-day[data-day="${dayIndex}"]`);
            if (!dayContainer) {
                dayContainer = createDayContainer(dayIndex);
            }
            
            // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ›´æ–°
            updateDayContent(dayContainer, dayData);
            
            // è¡¨ç¤º
            document.querySelectorAll('.forecast-day').forEach(el => el.style.display = 'none');
            dayContainer.style.display = 'block';
        }
        
        // æ—¥åˆ¥ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆ
        function createDayContainer(dayIndex) {
            const container = document.createElement('div');
            container.className = 'forecast-day';
            container.dataset.day = dayIndex;
            container.innerHTML = `
                <div class="overall-condition">
                    <!-- å‹•çš„ã«è¨­å®š -->
                </div>
                
                <div class="forecast-sections">
                    <div class="forecast-section">
                        <div class="section-header">
                            ğŸŒ¡ï¸ åŸºæœ¬æ°—è±¡æ¡ä»¶
                            <span class="time-range">04:00-16:00</span>
                        </div>
                        <div class="hourly-forecast basic-weather">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <div class="forecast-section">
                        <div class="section-header">
                            ğŸ’¨ é¢¨å‘ãƒ»é¢¨é€Ÿ
                            <span class="time-range">04:00-10:00</span>
                        </div>
                        <div class="hourly-forecast wind-data">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                    
                    <div class="forecast-section">
                        <div class="section-header">
                            â˜€ï¸ æ—¥å°„ãƒ»é›²é‡
                            <span class="time-range">10:00-16:00</span>
                        </div>
                        <div class="hourly-forecast solar-data">
                            <!-- å‹•çš„ã«ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <div class="judgment-section">
                    <div class="judgment-title">ğŸ¯ å¹²ã›ã‚‹ã‹ã©ã†ã‹ã®åˆ¤å®š</div>
                    <div class="judgment-result">
                        <!-- å‹•çš„ã«è¨­å®š -->
                    </div>
                    <div class="judgment-reasons">
                        <!-- å‹•çš„ã«è¨­å®š -->
                    </div>
                </div>
            `;
            
            document.querySelector('.forecast-content').appendChild(container);
            return container;
        }
        
        // æ—¥åˆ¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æ›´æ–°
        function updateDayContent(container, dayData) {
            // å…¨ä½“æ¡ä»¶
            const overallEl = container.querySelector('.overall-condition');
            const conditionClass = `condition-${dayData.overall_condition}`;
            overallEl.className = `overall-condition ${conditionClass}`;
            
            const conditionText = {
                excellent: 'ğŸŒŸ å¹²ã›ã‚‹ï¼ï¼ˆæœ€è‰¯æ¡ä»¶ï¼‰',
                good: 'â˜€ï¸ å¹²ã›ã‚‹ï¼ˆè‰¯å¥½æ¡ä»¶ï¼‰',
                fair: 'âš ï¸ æ¡ä»¶ä»˜ãã§å¹²ã›ã‚‹',
                poor: 'âŒ å¹²ã™ã®ã¯å›°é›£'
            };
            overallEl.textContent = conditionText[dayData.overall_condition];
            
            // åŸºæœ¬æ°—è±¡æ¡ä»¶
            const basicEl = container.querySelector('.basic-weather');
            basicEl.innerHTML = '';
            dayData.basic_weather.forEach(hourData => {
                const hourEl = document.createElement('div');
                hourEl.className = 'hour-item';
                hourEl.innerHTML = `
                    <div class="hour-time">${hourData.hour}:00</div>
                    <div class="hour-value">${hourData.temperature.toFixed(1)}<span class="hour-unit">Â°C</span></div>
                    <div class="hour-value">${hourData.humidity.toFixed(0)}<span class="hour-unit">%</span></div>
                `;
                basicEl.appendChild(hourEl);
            });
            
            // é¢¨å‘ãƒ»é¢¨é€Ÿ
            const windEl = container.querySelector('.wind-data');
            windEl.innerHTML = '';
            dayData.wind_data.forEach(hourData => {
                const hourEl = document.createElement('div');
                hourEl.className = 'hour-item';
                const windArrow = getWindArrow(hourData.direction);
                hourEl.innerHTML = `
                    <div class="hour-time">${hourData.hour}:00</div>
                    <div class="wind-direction">
                        <div class="wind-arrow">${windArrow}</div>
                        <div class="theta-diff">Î”${hourData.theta_diff.toFixed(0)}Â°</div>
                    </div>
                    <div class="hour-value">${hourData.speed.toFixed(1)}<span class="hour-unit">m/s</span></div>
                `;
                windEl.appendChild(hourEl);
            });
            
            // æ—¥å°„ãƒ»é›²é‡
            const solarEl = container.querySelector('.solar-data');
            solarEl.innerHTML = '';
            dayData.solar_data.forEach(hourData => {
                const hourEl = document.createElement('div');
                hourEl.className = 'hour-item';
                hourEl.innerHTML = `
                    <div class="hour-time">${hourData.hour}:00</div>
                    <div class="hour-value">${hourData.solar.toFixed(0)}<span class="hour-unit">W/mÂ²</span></div>
                    <div class="hour-value">${hourData.cloud.toFixed(0)}<span class="hour-unit">%</span></div>
                    <div class="hour-value">${hourData.ssi.toFixed(1)}<span class="hour-unit">SSI</span></div>
                `;
                solarEl.appendChild(hourEl);
            });
            
            // åˆ¤å®šçµæœ
            const judgmentResultEl = container.querySelector('.judgment-result');
            const judgmentClass = `judgment-${dayData.overall_condition}`;
            judgmentResultEl.className = `judgment-result ${judgmentClass}`;
            judgmentResultEl.textContent = `${dayData.judgment.result}ï¼ˆä¿¡é ¼åº¦: ${dayData.confidence}%ï¼‰`;
            
            const judgmentReasonsEl = container.querySelector('.judgment-reasons');
            judgmentReasonsEl.innerHTML = dayData.judgment.reasons.map(reason => `â€¢ ${reason}`).join('<br>');
        }
        
        // é¢¨å‘çŸ¢å°ã‚’å–å¾—
        function getWindArrow(direction) {
            const arrows = ['â†“', 'â†™', 'â†', 'â†–', 'â†‘', 'â†—', 'â†’', 'â†˜'];
            const index = Math.round(direction / 45) % 8;
            return arrows[index];
        }
        
        // æˆ»ã‚‹ãƒœã‚¿ãƒ³
        function goBack() {
            if (document.referrer && document.referrer.includes('hoshiba_map.html')) {
                history.back();
            } else {
                window.location.href = 'hoshiba_map.html';
            }
        }
        
        // åˆæœŸåŒ–å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>